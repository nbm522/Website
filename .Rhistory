set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(primary.enforcement~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
blogdown::serve_site()
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(y~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 12, 14) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(primary.enforcement~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(as.numeric(y)~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 12, 14) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(primary.enforcement~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
View(traffic2)
blogdown::serve_site()
View(traffic2)
View(traffic3)
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(as.numeric(y)~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 13) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(primary.enforcement~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
View(traffic3)
blogdown::serve_site()
blogdown::serve_site()
blogdown::serve_site()
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(as.numeric(y)~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 13) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(primary.enforcement~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(as.numeric(y)~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 13) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(y~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
View(train)
View(test)
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(as.numeric(y)~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 13) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$y
fit4<-glm(y~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(as.numeric(y)~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 13) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(y~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(as.numeric(y)~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 13) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(primary.enforcement~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
sapply(traffic,class)
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(as.numeric(y)~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 13) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(y~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
View(train)
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(as.numeric(y)~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 13) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(primary.enforcement~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
sapply(traffic,class)
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(y~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 12, 14) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(primary.enforcement~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(y~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1, 12, 14) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(y~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
View(train)
View(traffic3)
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(y~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1,13) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(y~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
View(traffic3)
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(y~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(y~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
library(plotROC)
library(dplyr)
library(lmtest)
traffic2<-traffic%>%mutate(y=ifelse(primary.enforcement=="yes",1,0))
fit3<- glm(y~party+helmet_law, traffic2, family="binomial")
coeftest(fit3)
exp(coef(fit3))
prob<-predict(fit3,type="response")
class_diag(prob,traffic2$y)
pred<-ifelse(prob>.5,1,0)
table(prediction=pred, truth=traffic2$y)%>%addmargins
traffic2$logit<-predict(fit3,type="link")
traffic2%>%ggplot()+geom_density(aes(logit,fill=primary.enforcement), alpha=.4)+
theme(legend.position=c(.85,.85))+geom_vline(xintercept=0)+xlab("predictor (logit)")
ROCplot<-ggplot(traffic2)+geom_roc(aes(d=y,m=prob), n.cuts=0)+
geom_segment(aes(x=0,xend=1,y=0,yend=1),lty=2)
ROCplot
calc_auc(ROCplot)
traffic3<- traffic2[ -c(1,13) ]
set.seed(1234)
k=10
data<-traffic3[sample(nrow(traffic3)),]
folds<-cut(seq(1:nrow(traffic3)),breaks=k,labels=F)
diags<-NULL
for(i in 1:k){
train<-data[folds!=i,]
test<-data[folds==i,]
truth<-test$primary.enforcement
fit4<-glm(y~(.)^2,data=train,family="binomial")
probs<-predict(fit4,newdata = test,type="response")
diags<-rbind(diags,class_diag(probs,truth))
}
View(traffic2)
View(traffic3)
